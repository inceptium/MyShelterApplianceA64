var elemento=function(){var c="";var p="set4";var z=null;var j=false;var B="0";var d="";var u="";var n=this;var t="0";var k="";var f=new Image();var e=new Image();var b="";var A=0;var g;var q="";var o;this.tempoInvioComando=0;var i=false;var a=false;var l="";this.setIdGruppo=function(D){l=D};this.setSetIcone=function(D){if(D=="set1"||D=="set2"||D=="set3"||D=="set4"){p=D}};this.getAggiornamentoElementoInCorso=function(){var D=i;return D};this.getSetIcone=function(){var D=p;return D};this.setIdElemento=function(D){b=D};this.setRigheStatusMonitor=function(D){o=D};this.getRigheStatusMonitor=function(){var D=o;return D};this.getComandoInviato=function(){var D=j;return D};this.setComandoInviato=function(D){j=D};this.getIdElemento=function(){var D=b;return D};this.setMioContesto=function(D){z=D;n=this};this.setMioCanvas=function(D){if("ontouchstart" in document.documentElement){D.addEventListener("touchstart",r,false);D.addEventListener("touchend",C,false);D.addEventListener("touchmove",w,false)}else{D.addEventListener("click",C,false)}g=D};this.settaImmagini=function(E,D){var H=canvasImmaginiMomentanee.getContext("2d");var G=localStorage.getItem(E);if(G==null){f.src=E;f.onload=function(){H.fillStyle="white";H.fillRect(0,0,142,120);H.drawImage(f,0,0);if(localStorage.immagine=="si"){localStorage.setItem(E,canvasImmaginiMomentanee.toDataURL())}}}else{f.src=G}var F=localStorage.getItem(D);if(F==null){e.src=D;e.onload=function(){H.fillStyle="white";H.fillRect(0,0,142,120);H.drawImage(e,0,0);if(localStorage.immagine=="si"){localStorage.setItem(D,canvasImmaginiMomentanee.toDataURL())}}}else{e.src=F}n.rinfresca()};this.elemento=function(){};this.setStatoCorrente=function(D){a=false;t=D;i=false};this.getStatoCorrente=function(){var D=t;return D};this.rinfresca=function(){var D=null;if(k=="9"){if(localStorage.getItem(b+"StatusMonitor")=="Letto"){D=e;z.fillStyle="white";z.fillRect(0,0,142,120)}else{D=f;z.fillStyle="white";z.fillRect(0,0,142,120)}}else{if(i==true){z.fillStyle="yellow";z.fillRect(0,0,142,120)}else{z.fillStyle="white";z.fillRect(0,0,142,120)}}if(k!="9"){if(t=="1"){D=f}else{D=e}}z.drawImage(D,0,0);if(i==false){if(a){z.strokeStyle="#FF0000";z.lineWidth=5;z.strokeRect(0,0,142,110)}}else{if(k!=11){z.fillStyle="yellow";z.fillRect(82,2,55,6)}else{z.fillStyle="yellow";z.fillRect(12,6,120,4)}}z.font="14px Arial";if(localStorage.setIcone=="set3"){z.fillStyle="black";z.strokeStyle="black";if(k==2||k==5||k==7){if(t=="1"){z.fillStyle="white";z.strokeStyle="white"}}}else{z.fillStyle="white";z.strokeStyle="white"}switch(k){case"6":wrapText(z,B+" S",70,38,70,15,1);wrapText(z,c,10,80,127,15,1);break;case"7":wrapText(z,B+" "+d,70,38,70,15,1);wrapText(z,c,10,80,127,15,1);break;case"5":wrapText(z,B,70,38,70,15,1);wrapText(z,c,10,80,127,15,1);break;case"9":var E=95;if(o==undefined){o="00"}else{if(parseInt(o)<9){o="0"+parseInt(o)}else{if(parseInt(o)>=99){o="99+";E=93}}}z.fillText(o,E,34);wrapText(z,c,10,80,127,15,1);if(textAreaAperta==b){if($("#testoStringa").text()!=u){$("#testoStringa").empty();$("#testoStringa").append(u)}}break;case"11":z.font="20px Arial";wrapText(z,c,14,30,127,20,3);break;default:wrapText(z,c,10,80,127,15,1);break}if(localStorage.editMode=="si"){z.strokeStyle="#FF0000";z.lineWidth=2;z.strokeRect(0,0,68,53)}z.save();z.stroke()};this.setValoreLabel=function(D){d=D};this.setEtichetta=function(D){c=D};this.setValoreNumerico=function(D){B=D;i=false};this.getValoreNumerico=function(){var D=B;return D};this.setValoreStringa=function(D){u=D;i=false};this.getValoreStringa=function(){var D=u;return D};this.setTipoElemento=function(D){k=D;switch(k){case"2":n.settaImmagini("images/"+p+"/schedulatore/schedulatoreAcceso.png","images/"+p+"/schedulatore/schedulatoreSpento.png");q="schedulatore";break;case"3":n.settaImmagini("images/"+p+"/interruttore/interruttoreAcceso.png","images/"+p+"/interruttore/interruttoreSpento.png");q="interruttore";break;case"5":n.settaImmagini("images/"+p+"/ingresso/ingressoAcceso.png","images/"+p+"/ingresso/ingressoSpento.png");q="ingresso";break;case"6":n.settaImmagini("images/"+p+"/interruttoreTem/interruttoreTemAcceso.png","images/"+p+"/interruttoreTem/interruttoreTemSpento.png");q="interruttoreTem";break;case"7":n.settaImmagini("images/"+p+"/ingressoAnalogico/ingressoAnalogicoAcceso.png","images/"+p+"/ingressoAnalogico/ingressoAnalogicoSpento.png");q="ingressoAnalogico";break;case"8":n.settaImmagini("images/"+p+"/pulsanteAuto/pulsanteAutoAcceso.png","images/"+p+"/pulsanteAuto/pulsanteAutoSpento.png");q="pulsanteAuto";break;case"9":n.settaImmagini("images/"+p+"/statusMonitor/statusMonitorAcceso.png","images/"+p+"/statusMonitor/statusMonitorSpento.png");q="statusMonitor";break;case"10":n.settaImmagini("images/"+p+"/send/sendAcceso.png","images/"+p+"/send/sendSpento.png");q="send";break;case"11":n.settaImmagini("images/"+p+"/gruppo/gruppo.png","images/"+p+"/gruppo/gruppo.png");q="gruppo";break;default:}};function r(D){D.preventDefault();if(m(D)==true){a=true;A=0;n.rinfresca()}}function C(D){D.preventDefault();
a=false;A=1;n.rinfresca();if(v(D)==true&&localStorage.editMode=="si"){h()}else{if(m(D)==true){s()}}}function v(G){x=74;y=128;var F=false;if("ontouchstart" in document.documentElement){G.preventDefault();var H=G.changedTouches;var E=(H[0].pageX-g.offsetLeft);var D=(H[0].pageY-g.offsetTop);if(E<x&&D<y){F=true}}else{E=(G.clientX-g.offsetLeft);D=(G.clientY-g.offsetTop);if(E<x&&D<y){F=true}}return F}function m(H){var D;var J;var G=false;switch(k){case"11":D=141;J=179;break;default:D=74;J=128;break}if("ontouchstart" in document.documentElement){H.preventDefault();var I=H.changedTouches;var F=(I[0].pageX-g.offsetLeft);var E=(I[0].pageY-g.offsetTop);if(F<D&&E<J){G=true}}else{F=(H.clientX-g.offsetLeft);E=(H.clientY-g.offsetTop);if(F<D&&E<J){G=true}}return G}function w(D){D.preventDefault();A=0;a=false;n.rinfresca()}function h(){finestraIcone=new finestra();iconePersonalizzate1.leggiCartellaSet(p,q);finestraIcone.apriFinestra2(iconePersonalizzate1.formulaContenutoHtml(p,q))}function s(){if(localStorage.editMode!="si"||k=="11"){if(k!="2"&&k!="5"&&k!="7"){if(j==false){if(A==1){i=true;window.setTimeout(function(){n.rinfresca()},100);switch(k){case"11":gruppoInCarica=true;window.setTimeout(function(){arrayElementi=new Array();gruppo1=new caricaGruppo(b);gruppo1.carica()},400);break;case"9":finestraValoreStringa=new finestra();finestraValoreStringa.apriFinestra(u,b);localStorage.setItem(b+"StatusMonitor","Letto");localStorage.statusMonitorLetto="Letto";i=false;break;default:j=true;var D=new comandoHttp();D.setElementoChiamante(n);var E=new Date();n.tempoInvioComando=E.getTime();window.setTimeout(function(){if(t=="1"){D.inviaComando("command=set_deactive?"+b)}else{D.inviaComando("command=set_active?"+b)}},100);break}}}}}else{h()}}};